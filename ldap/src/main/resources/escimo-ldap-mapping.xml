<?xml version="1.0"?>
<entities>
    <!-- Core User resource schema -->
    <schema id="user-core" uri="urn:scim:schemas:core:1.0">
        <attribute name="id" mappedTo="entryUUID" />
        <attribute name="userName" mappedTo="uid" />
        <attribute name="displayName" mappedTo="displayName" />
        <attribute name="nickName" mappedTo="" />
        <attribute name="profileUrl" mappedTo="" />
        <attribute name="title" mappedTo="title" />
        <attribute name="userType" mappedTo="employeeType" />
        <attribute name="preferredLanguage" mappedTo="preferredLanguage" />
        <attribute name="locale" mappedTo="" />
        <attribute name="timezone" mappedTo="" />
        <attribute name="active" handlerRef="activeHandler" />
        <attribute name="password" show="false" mappedTo="userPassword" />

        <complex-attribute name="name">
            <at-group>
                <attribute name="familyName" mappedTo="sn" />
                <attribute name="givenName" mappedTo="cn" />
                <attribute name="middleName" mappedTo="" />
                <attribute name="honorificPrefix" mappedTo="title" />
                <attribute name="honorificSuffix" mappedTo="" />
                <formatted format="$givenName $familyName" />
            </at-group>
        </complex-attribute>

        <multival-attribute name="emails">
            <type name="work" primary="true">
                <at-group>
                    <attribute name="value" mappedTo="mail" />
                </at-group>
            </type>
        </multival-attribute>

        <multival-attribute name="phoneNumbers">
            <type name="work" primary="true">
                <at-group>
                    <attribute name="value" mappedTo="telephoneNumber" />
                </at-group>
            </type>
            <type name="home" primary="false">
                <at-group>
                    <attribute name="value" mappedTo="homePhone" />
                </at-group>
            </type>
        </multival-attribute>

        <multival-attribute name="ims">
        </multival-attribute>

        <multival-attribute name="photos" handlerRef="photosHandler">
            <type name="photo" primary="true">
                <at-group>
                    <attribute name="value" mappedTo="jpegPhoto" />
                </at-group>
            </type>
        </multival-attribute>

        <multival-attribute name="addresses">
            <type name="work" primary="true">
                <at-group>
                    <attribute name="streetAddress" mappedTo="street" />
                    <attribute name="locality" mappedTo="l" />
                    <attribute name="region" mappedTo="region" />
                    <attribute name="postalCode" mappedTo="postalCode" />
                    <attribute name="country" mappedTo="" />
                    <formatted format="$streetAddress $locality" />
                </at-group>
            </type>
        </multival-attribute>

        <multival-attribute name="groups" basedDn="ou=system"
            filter="(uniqueMember = $entryDn)" handlerRef="groupsHandler" />

        <multival-attribute name="entitlements" />

        <multival-attribute name="roles" />

        <multival-attribute name="x509Certificates">
            <at-group>
                <attribute name="value" mappedTo="userCertificate" />
            </at-group>
        </multival-attribute>

        <complex-attribute name="meta" handlerRef="metaHandler" />

    </schema>

    <!-- Enterprise User resource schema -->
    <schema id="enterprise-user" uri="urn:scim:schemas:extension:enterprise:1.0">
        <attribute name="employeeNumber" mappedTo="" />
        <attribute name="costCenter" mappedTo="" />
        <attribute name="organization" mappedTo="" />
        <attribute name="division" mappedTo="" />
        <attribute name="department" mappedTo="" />

        <complex-attribute name="manager">
            <at-group>
                <attribute name="managerId" mappedTo="" />
                <attribute name="$ref" mappedTo="" />
                <attribute name="displayName" mappedTo="" />
            </at-group>
        </complex-attribute>
    </schema>

    <schema id="group" uri="urn:scim:schemas:core:1.0">
        <attribute name="displayName" mappedTo="cn" />
        <attribute name="id" mappedTo="entryUUID" />
        <multival-attribute name="members" handlerRef="membersHandler"/>
    </schema>

    <userType basedDn="ou=system" filter="(objectClass = inetOrgPerson)">
        <schemaRef id="user-core" />
        <schemaRef id="enterprise-user" />
    </userType>

    <groupType basedDn="ou=system" filter="(objectClass = inetOrgPerson)">
        <schemaRef id="group" />
    </groupType>

    <atHandlers>
        <handler name="activeHandler"
            class="org.apache.directory.scim.ldap.handlers.ActiveAttributeHandler" />
        <handler name="metaHandler"
            class="org.apache.directory.scim.ldap.handlers.MetaAttributeHandler" />
        <handler name="groupsHandler"
            class="org.apache.directory.scim.ldap.handlers.GroupsAttributeHandler" />
        <handler name="photosHandler"
            class="org.apache.directory.scim.ldap.handlers.PhotosAttributeHandler" />
        <handler name="membersHandler"
            class="org.apache.directory.scim.ldap.handlers.MembersAttributeHandler" />
    </atHandlers>
</entities>